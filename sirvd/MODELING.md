# Моделирование системы

## 1. Общая модель SIRVD

Необходимо смоделировать распространение инфекции.

Пусть в каждый момент времени всё население разделяется на группы:

- **S** — восприимчивые (Susceptible)
- **I** — заражённые (Infected)
- **R** — выздоровевшие (Recovered)
- **V** — вакцинированные (Vaccinated)
- **D** — умершие (Deceased)

Тогда общее население `N` будет составляться следующим образом:
$$
N = S + I + R + V + D \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1)
$$
В рамках моделирования будет необходимо следить за общим числом населения.

Количество инфицированных случаев $I(t)$ можно получить следующим образом:

$$I(t)$= C(t) - (R(t) + D(t)) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2)$$

------

## 2. Изменение во времени

Мы не знаем, например, как изменяется **S(t)** или любой другой параметр. Но мы знаем скорость их изменения.

Например:

- заражение происходит со скоростью, пропорциональной $S * I$
- выздоровление пропорционально $I$
- смертность пропорциональна $I$
- вакцинация пропорциональна $S$

Тогда модель SIRVD может быть представлена следующими обыкновенными дифференциальными уравнениями:

$$\frac{dS(t)}{dt} = -\frac{βI(t)S(t)}{N} + σR(t) - αS(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3)$$

$$\frac{dI(t)}{dt} = \frac{βI(t)S(t)}{N} - \gamma I(t) - \delta I(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4)$$

$$\frac{dR(t)}{dt} = \gamma I(t) - σR(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5)$$

$$\frac{dV(t)}{dt} = αS(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (6)$$

$$\frac{dD(t)}{dt} = \delta I(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (7)$$

$$N = S(t) + I(t) + R(t) + V(t) + D(t) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1)$$



Рассмотрим за что отвечают различные коэффициенты в этой системе ОДУ:

1. $α$ — **показатель вакцинации**, который отражает долю восприимчивых, которые вакцинируются в единицу времени (S → V);
2. $β$ — **коэффициент заражения**, описывающий скорость появления новых зараженных (S → I);
3. $\gamma$ — **уровень выздоровления**, т. е. доля зараженных за единицу времени, которые выздоравливают (I → R)
4. $\delta$ — **показатель смертности**, обозначающий долю зараженных, которые умирают в единицу времени (I → D)
5. $σ$ — **коэффициент восприимчивости** (потеря иммунитета), то есть доля выздоровевших, которая снова становится восприимчивой (R → S).



Нам необходимо узнать, как изменяется во времени количество восприимчивых $S(t)$, однако для него нет формулы. Известна только скорость изменения $\frac{dS(t)}{dt}$. Чтобы решить эту проблему, придется прибегнуть к **численному методу** решения системы обыкновенных дифференциальных уравнений.

------

## 3. Численный метод Эйлера

Рассмотрим один из возможных численных методов решения систему ОДУ — метод Эйлера.

### 3.1. Теория о методе Эйлера

Если у нас есть уравнение вида $\frac{dx}{dt} = f(x)$, то метод Эйлера говорит, что:

$$x_{n+1} = x_n + h * f(x_n)$$, где:

- $h$ — малый шаг по времени (например, 0.1 дня);
- $x_n$ — значение в текущий момент;
- $f(x_n) = \frac{dx_n}{dt}$ — скорость изменения.



Если говорить простыми словами, то метод позволяет утверждать так:

> Новое значение = Старое значение + (Скорость * Маленький Шаг)



На нашем примере моделирования системы распространения заражения среди группы людей численный метод Эйлера слабо применим, потому что является неточным и сильно зависит от шага. Поэтому прибегнем к иному методу — методу Рунге-Кутты (RK), который часто применяется при моделировании систем.

------

## 4. Метод Рунге-Кутты

Рассмотрим метод Рунге-Кутты решения системы ОДУ и применим его для моделирования нашей системы.

### 4.1. Теория о методе Рунге-Кутты (RK)

Что такое метод Рунге-Кутты? Это более «умный» способ вычислять состояние системы в зависимости от времени: *вместо того, чтобы брать скорость только в начале шага, мы будем оценивать её несколько раз внутри шага*.

#### RK2 (порядок 2)

Берем две оценки скорости:

- скорость в начале;
- скорость в середине.

Усредняем эти оценки и получаем более точную по сравнению с Эйлером.

#### RK4 (порядок 4)

Используем четыре оценки:

- в начале;
- два раза в середине;
- в конце.

Зачастую этот способ является золотым стандартом.

#### Порядок метода

На примере метода Рунге-Кутты четвертого порядка (RK4) рассмотрим понятие **порядка метода точности**. Если метод имеет четвертый порядок точности, это значит, что ошибка на одном шаге имеет порядок $O(h^5)$, а суммарная ошибка на конечном интервале интегрирования имеет порядок $O(h^4)$.

------

## 5. Адаптивный метод

В рамках моделирования системы заражения будет применяться адаптивный метод Рунге-Кутты. Его отличие от обычного заключается в том, что в обычном RK4 применяется **фиксированный** шаг $h$. В то время как адаптивный метод сам меняет шаг, подбирая оптимальное значение:

- если ошибка нарастает, то метод уменьшает шаг;
- пока все хорошо, шаг увеличивается.

Реализация адаптивного метода достигается следующим образом:

1. Внутри одного шага считается *два решения разной точности* (например, пятого и шестого порядков).
2. Разница между ними аппроксимируется до оценки ошибки — это и является RK5(6).

------

## 6. План моделирования

Примерный план моделирования рассматриваемой системы выглядит так:

1. Реализовать систему SIRVD (математически).
2. Решить реализованную систему различными численными методами:
   - RK2;
   - RK3;
   - RK4;
   - RK5(6) (адаптивный).
3. Построить 2D графики состояния системы.
4. Сравнить реализованные методы.



Реализация системы будет происходить на языке C для производительности и точного контроля памяти.

Для изображения 2D-графиков для удобства применим Python.

