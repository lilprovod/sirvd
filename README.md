# Моделирование инфекционного заболевания (SIRVD)

Численная модель эпидемии SIRVD с использованием различных методов:

- Метод Эйлера (Euler)
- Метод Рунге — Кутты порядка 2 (RK2)
- Метод Рунге — Кутты порядка 3 (RK3)
- Метод Рунге — Кутты порядка 4 (RK4)
- Адаптивный метод Рунге — Кутты (RK5(6)) с автоматическим выбором шага `h`

## Работа с моделью

Работа с моделью происходит следующим образом:

1. Необходимо скомпилировать бинарный файл для запуска моделирования.
2. Запустить бинарный файл:
   1. без аргументов — для стандартных параметров
   2. передать аргументы в виде пар «ключ-значение» для тонкой регулировки модели
3. Отобразить графики с помощью модуля Python

## Инструкция

### 0. **Загрузите модель на компьютер**

Клонируйте репозиторий для работы с моделью SIRVD:

```bash
git clone https://github.com/lilprovod/sirvd
```

### 1. **Скомпилируйте программу**

В командной строке перейдите в каталог репозитория. Примените следующую команду для компиляции:

```bash
gcc -std=c99 src/main.c src/rk.c src/sirvd.c -O2 -Iinclude -lm -o sirvd
```

### 2. Запустите моделирование

Чтобы начать стандартное моделирование (с параметрами по умолчанию), запустите скомпилированный файл:

```bash
.\sirvd
```

Программа принимает аргументы в формате `key=value` для тонкой настройки модели. Пример запуска:

```bash
.\sirvd method=rk56 h=0.5 t_end=365 out=result.csv
```

#### Доступные параметры

##### **Численный метод**

| Ключ | Значение | Значение по умолчанию |
| :---: | :---: | :---: |
| `method`  `m` | `euler`, `rk2`, `rk3`, `rk4`, `rk56` | `rk4` |

Пример:

```bash
method=euler
```

##### Параметры интегрирования

| Ключ | Описание | Тип | Значение по умолчанию |
| :---: | :---: | :---: | :---: |
| `h` | Начальный шаг интегрирования | `double > 0` | `0.1` |
| `t_end`  `time`  `t` | Время моделирования (дни) | `double > 0` | `1000.0` |
| `atol` | Абсолютная точность (RK56) | `double > 0` | `1.0` |
| `rtol` | Относительная точность (RK56) | `double >= 0` | `1e-6` |

Пример:

```bash
h=0.2 t_end=10000 atol=2 rtol=1e-7
```

##### Параметры модели SIRVD

| Ключ | Описание | Тип | Значение по умолчанию |
| :---: | :---: | :---: | :---: |
| `N` | Общее население | `double > 0` | `1 000 000.0` |
| `alpha`  `a` | Показатель вакцинации  | `0 <= double <= 1` | `0.0015` |
| `beta`  `b` | Коэффициент заражения | `0 <= double <= 1` | `0.25` |
| `gamma`  `g` | Уровень выздоровления | `0 <= double <= 1` | `0.10` |
| `delta`  `d` | Показатель смертности | `0 <= double <= 1` | `0.0005` |
| `sigma`  `s` | Коэффициент восприимчивости | `0 <= double <= 1` | `0.005` |

Пример:

```bash
N=10000000 beta=0.22 sigma=0.35
```

##### Начальные условия модели

| Ключ | Описание | Тип | Значение по умолчанию |
| :---: | :---: | :---: | :---: |
| `i_start`  `i0` | Начальное число зараженных | `0 <= double <= N` | `10.0` |
| `r_start`  `r0` | Начальное число выздоровевших  | `0 <= double <= N` | `0.0` |
| `v_start`  `v0` | Начальное число вакцинированных | `0 <= double <= N` | `0.0` |
| `d_start`  `d0` | Начальное число умерших | `0 <= double <= N` | `0.0` |

Пример:

```bash
i0=10000 r0=137 d0=5
```

##### Файл вывода

| Ключ | Описание | Тип | Значение по умолчанию |
| :---: | :---: | :---: | :---: |
| `o`  `out`  `output`  `output_file` | Имя выходного **CSV-файла** | `string` | `output.csv` |

Пример:

```bash
out=experiment_1.csv
```

### 3. **Изучите графики**

Используйте специальный модуль на Python, чтобы отобразить графики модели. Графики строятся на основании CSV-файла. По умолчанию используется `output.csv`. Чтобы построить графики, используйте команду:

```bash
python -m plot output_filename.csv
```

